The 19-year-old man accused of shooting 17 people to death at a Florida high school legally purchased the assault rifle used in the killings and may have foreshadowed the attack in a social media comment investigated by the FBI last year. New details about the troubled background and gun ownership of the suspect, Nikolas Cruz, emerged as he appeared in court to face formal charges of carrying out the second-deadliest mass shooting at a public school in US history. Authorities also shed more light on how the suspect made a getaway by blending in with students fleeing the school, then casually spent more than an hour drifting through a Walmart store and visiting two fast-food outlets before he was arrested. The tragedy in the Miami suburb of Parkland, Florida, raised questions among anguished parents about the adequacy of school security measures and renewed a national debate on Capitol Hill and elsewhere about the epidemic of gun violence in American schools. Thousands filled an outdoor amphitheater in Parkland Thursday night to attend a candlelight memorial vigil, where several speakers elicited thunderous applause from the crowd as they called for tougher gun control measures. The Federal Bureau of Investigation disclosed it received a tip in September about an ominous online message that read: "I'm going to be a professional school shooter." The comment had been posted to someone else's YouTube video by a person going by the name of Nikolas Cruz, now presumed to be the same individual as the suspect in the Florida shooting. However, FBI agents had no information pointing to the "time, location or true identity" of the person behind the message, Robert Lasky, special agent in charge of the FBI's Jacksonville office, told reporters. YouTube ultimately removed the material in question, and the FBI's inquiry was dropped until the name Nikolas Cruz surfaced again in connection with Wednesday's massacre at Marjory Stoneman Douglas High School. Read: Florida shooting: At least 17 dead in high school attack Also read: Florida shooting: Casualties reported as suspect arrested ARRIVED VIA UBER, LEFT WITH FLEEING STUDENTS Authorities say the gunman, identified as a former student at Stoneman Douglas High who had been expelled for disciplinary problems, walked into the school shortly before dismissal time, pulled a fire alarm and opened fire as students and teachers streamed out of classrooms into the halls. Seventeen people died and 15 were injured in the ensuing violence. The suspect was armed with an AR-15-style semiautomatic assault rifle and numerous ammunition cartridges. Broward County Sheriff Scott Israel said Cruz legally purchased the murder weapon from a licensed dealer, Sunrise Tactical Supply, in Coral Springs, Florida. The sheriff also said Cruz arrived at the school by way of the Uber ride-sharing service and left the scene on foot, mixing in "with a group that were running away, fearing for their lives." He walked into a Walmart, bought a beverage at a Subway outlet inside the store, then visited a McDonald's before he was finally spotted and detained by a police officer in the adjacent town of Coconut Creek, Israel said. Cruz, charged with 17 counts of premeditated murder, made a brief initial court appearance on Thursday, in which he was ordered held without bond. He spoke only two words - "Yes ma'am" - when a judge asked him to confirm his name. Cruz's court-appointed lawyer said her client had expressed remorse for his crimes. "He's a broken human being," public defender Melissa McNeill told reporters. "He's sad, he's mournful, he's remorseful." According to a court document made public on Thursday, Cruz admitted to police after being arrested and advised of his right to avoid self-incrimination that he had committed the attack. Former classmates have described Cruz as a social outcast with a reputation as a trouble-maker, as well as someone who was "crazy about guns." The sheriff has said some of the online and social media activity Cruz engaged in was "very, very disturbing." On Thursday, a local leader of the white nationalist militia Republic of Florida, Jordan Jereb, said Cruz had participated in paramilitary training with that group at some point, though Reuters could not immediately verify this. Wednesday's shooting was the 18th in a US school this year, according to gun control group Everytown for Gun Safety. It also ranks as the greatest loss of life from school gun violence after the 2012 shooting rampage at Sandy Hook Elementary School in Newtown, Connecticut, that left 20 first-graders and six adult educators dead.  US President Donald Trump speaks about the mass shooting at a Florida high school in a national address from the White House in Washington, February 15, 2018. /REUTERS President Donald Trump addressed the shooting in a White House speech that emphasized school safety and mental health while avoiding any mention of gun policy. "It is not enough to simply take actions that make us feel like we are making a difference," Trump said at the White House. "We must actually make that difference." Democrats in the US House of Representatives criticized the Republican leadership for refusing to take up legislation on tightening background checks for prospective gun buyers. "It's appalling," Representative Mike Thompson told reporters. "Thirty people every day are killed by someone using a gun, and the best we can do is say we need more information?" The Republican-controlled Congress last year revoked Obama-era regulations meant to make it harder for those with severe mental illness to pass FBI background checks for guns, saying it deprived the mentally ill of their gun rights. The American Civil Liberties Union joined in opposing the rule, saying there was no evidence that people with mental disabilities were more likely to commit gun violence. Some gun control proponents and legal experts said Wednesday's shooting might have been averted if Florida were among the handful of US states with laws allowing police and family members to obtain restraining orders barring people suspected of being a threat from possessing guns. Cruz had recently moved in with another family after his mother's November death, said Jim Lewis, a lawyer representing the family, bringing his AR-15 along with other belongings. The family believed Cruz was depressed, but attributed that to his mother's death, not mental illness, Lewis said. Click here for the latest local political stories