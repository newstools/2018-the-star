A teenager accused of fatally shooting 17 people at a Florida high school was investigated by police and state officials as far back as 2016 after slashing his arm in a social media video, and saying he wanted to buy a gun, but authorities determined he was receiving sufficient support, newspapers said on Saturday. Nikolas Cruz, 19, is charged with committing multiple murders on Wednesday at the Marjory Stoneman Douglas High School in Parkland. More than a dozen people also were wounded in the deadliest shooting at a US high school. Read: Florida shooting: At least 17 dead in high school attack The charges can bring the death penalty, but prosecutors have not yet said if they will seek capital punishment. Days after the killings, a somber series of vigils and funerals were being held in and around Parkland, a Fort Lauderdale suburb of about 32,000 people. The South Florida Sun Sentinel first reported that a video of Cruz cutting his arm posted to the social media network Snapchat in September 2016 raised concerns among law enforcement and at the Florida Department of Children and Families. "Mr. Cruz stated he plans to go out and buy a gun. It is unknown what he is buying the gun for," said a report written by department officials after investigators interviewed the teenager, the Sun Sentinel said. The newspaper reported investigators ultimately decided that Cruz, then 18, was receiving enough support from mental health professionals and from his school, and any risk in his case was low. The Department of Children and Families (DCF) has asked a court to release the records for transparency, adding it has reviewed the circumstances surrounding the 2016 case. "Mental health services and supports were in place when this investigation closed," DCF Secretary Mike Carroll said in a statement. The long-simmering US debate about gun rights played out on Saturday at events in the area. Hundreds of people attended a rally in Fort Lauderdale where students from the school demanded new gun control measures to tighten what they saw as easy access to firearms in the state. They also accused some politicians of being more concerned about protecting the firearms lobby than children. "Because of these (current) gun laws, people that I know, people that I love, have died," Delaney Tarr, a senior at the school, told the rally. At a nearby gunshow, attendees said new laws would not have prevented the massacre, adding gun rights are protected by the U.S. Constitution's Second Amendment. FBI UNDER PRESSURE The Federal Bureau of Investigation admitted on Friday that it failed to investigate a warning this year that Cruz possessed a gun and the desire to kill. A person described as close to Cruz called an FBI tip line on Jan. 5 to report concerns about him, according to the FBI. That information was not forwarded to the FBI's Miami office, in what agency officials called a breakdown in protocol. Read: FBI admits failure to act on Florida school gunman, draws anger The disclosure spread angry disbelief among Parkland residents and prompted Florida's Republican Governor Rick Scott to call for FBI Director Christopher Wray to resign. US Attorney General Jeff Sessions has ordered a review of FBI procedures following the shooting, in which 14 students and three school staff members died. US President Donald Trump called local politicians and the school's principal from his Mar-a-Lago, Florida, resort on Saturday to express condolences, offer support and receive updates, a White House spokeswoman said. On Friday, he visited shooting survivors and first responders. He and some other Republican political leaders have said mental illness prompted the massacre. Cruz had been expelled from the high school for undisclosed disciplinary reasons and former classmates described him as an outcast and troublemaker with a fascination for weaponry. As more details emerged on the suspect, CNN reported that Cruz posted disparaging comments about Jews, African Americans and gays in a private chat group on the social media network Instagram. "I think I am going to kill people," Cruz wrote in the group, according to CNN, which also quoted an unnamed law enforcement source as saying the suspect bought at least five guns in the past year. Cruz's attorneys at the Broward County Public Defender's Office did not return requests for comment on that or the 2016 report by Florida's Department of Children and Families. "This kid exhibited every single known red flag, from killing animals to having a cache of weapons to disruptive behavior to saying he wanted to be a school shooter," the county's public defender, Howard Finkelstein, told the New York Times. The paper said it also received a copy of the report. Speaking on Saturday at an event in Dallas, Texas, Vice President Mike Pence said Trump was making the safety of the nation's schools a top priority. "We will get to the bottom of what happened," Pence said, adding the administration would take "a renewed look at giving law enforcement and local authorities the tools they need to deal with individuals struggling with dangerous mental illness." Click here for the latest political news